#!/bin/bash
#Overwrite the default Localsettings.php
# FAQ:
# Q: Why isn't this file an overlay that is applied at time of iso generation?
# A: The password in Localsettings is autogenerated at install time.
#    We first need to scrape the value of that password from the existing 
#    LocalSettings files before we overwrite it.

TURNKEY_FILE="/etc/mediawiki/LocalSettings.php.turnkey"
SETTINGS_FILE="/etc/mediawiki/LocalSettings.php"
OVERLAY_FILE="/etc/mediawiki/LocalSettings.php.overlay"

if [ ! -e $TURNKEY_FILE ]; then
	mv $SETTINGS_FILE $TURNKEY_FILE
fi
mv $OVERLAY_FILE $SETTINGS_FILE

echo "Make $SETTINGS_FILE writeable by apache."
chown www-data $SETTINGS_FILE
